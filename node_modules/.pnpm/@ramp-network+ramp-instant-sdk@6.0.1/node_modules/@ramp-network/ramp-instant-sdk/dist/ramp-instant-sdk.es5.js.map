{"version":3,"file":"ramp-instant-sdk.es5.js","sources":["../src/body-scroll-lock.ts","../src/consts.ts","../src/types.ts","../src/utils.ts","../src/init-helpers.ts","../src/ramp-instant-sdk.ts"],"sourcesContent":["// Track if body scroll is locked\nlet isLocked = false;\nlet originalOverflow: string | null = null;\nlet originalPaddingRight: string | null = null;\nlet originalPosition: string | null = null;\nlet originalTop: string | null = null;\nlet originalLeft: string | null = null;\nlet originalWidth: string | null = null;\nlet originalHeight: string | null = null;\nlet scrollPosition: number | null = null;\n\n/**\n * Check if the device is iOS\n */\nfunction isIOS(): boolean {\n  return (\n    /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n    !(window as Window & { MSStream?: unknown }).MSStream\n  );\n}\n\n/**\n * Disables body scroll while preserving scroll position\n */\nexport function disableBodyScroll(): void {\n  if (!isLocked) {\n    const body = document.body;\n    const scrollbarWidth = window.innerWidth - body.clientWidth;\n\n    // Store original values\n    originalOverflow = body.style.overflow;\n    originalPaddingRight = body.style.paddingRight;\n    originalPosition = body.style.position;\n    originalTop = body.style.top;\n    originalLeft = body.style.left;\n    originalWidth = body.style.width;\n    originalHeight = body.style.height;\n\n    // Store scroll position\n    scrollPosition = window.scrollY;\n\n    // Prevent body scroll\n    body.style.overflow = 'hidden';\n\n    // Prevent layout shift by adding padding for scrollbar\n    if (scrollbarWidth > 0) {\n      body.style.paddingRight = `${scrollbarWidth}px`;\n    }\n\n    // iOS Safari specific handling\n    if (isIOS()) {\n      body.style.position = 'fixed';\n      body.style.top = `-${scrollPosition}px`;\n      body.style.left = '0';\n      body.style.width = '100%';\n      body.style.height = '100%';\n      body.style.touchAction = 'none';\n    }\n\n    isLocked = true;\n  }\n}\n\n/**\n * Re-enables body scroll\n */\nexport function clearAllBodyScrollLocks(): void {\n  if (isLocked) {\n    const body = document.body;\n\n    // Restore original values\n    body.style.overflow = originalOverflow || '';\n    body.style.paddingRight = originalPaddingRight || '';\n    body.style.position = originalPosition || '';\n    body.style.top = originalTop || '';\n    body.style.left = originalLeft || '';\n    body.style.width = originalWidth || '';\n    body.style.height = originalHeight || '';\n    body.style.touchAction = '';\n\n    // Restore scroll position for iOS\n    if (isIOS() && scrollPosition !== null) {\n      window.scrollTo(0, scrollPosition);\n    }\n\n    originalOverflow = null;\n    originalPaddingRight = null;\n    originalPosition = null;\n    originalTop = null;\n    originalLeft = null;\n    originalWidth = null;\n    originalHeight = null;\n    scrollPosition = null;\n    isLocked = false;\n  }\n}\n","export const baseWidgetUrl = 'https://app.rampnetwork.com/';\n\nexport const SEND_CRYPTO_SUPPORTED_VERSION = 1 as const;\n\n// It will be evaluated by rollup-plugin-version-injector\nexport const SDK_VERSION = '[VI]{version}[/VI]';\n","import { SEND_CRYPTO_SUPPORTED_VERSION } from './consts';\n\ntype TAsset = string;\ntype TEthAddress = string;\ntype TSwapAmount = string;\ntype THostLogoUrl = string;\ntype THostApiKey = string;\ntype THostAppName = string;\ntype TURL = string;\ntype TDateString = string;\ntype TFiatCurrency = string;\ntype TFiatValue = string;\ntype TAddress = string;\ntype TEmailAddress = string;\ntype TCryptoAmount = string;\ntype TAssetExchangeRate = number;\ntype TFinalTxHash = string;\ntype TActionID = string;\ntype TNewActionStatus = string;\ntype TActionTimestamp = string;\ntype TActionDetails = string;\ntype TWebhookStatusUrl = string;\ntype TFinalUrl = string;\ntype TContainerNode = HTMLElement;\ntype TFlow = 'ONRAMP' | 'OFFRAMP';\n\nexport enum PaymentMethodName {\n  MANUAL_BANK_TRANSFER = 'MANUAL_BANK_TRANSFER',\n  AUTO_BANK_TRANSFER = 'AUTO_BANK_TRANSFER',\n  CARD_PAYMENT = 'CARD_PAYMENT',\n  APPLE_PAY = 'APPLE_PAY',\n}\n\nexport enum PaymentMethodType {\n  SEPA = 'SEPA',\n  CARD = 'CARD',\n  APPLEPAY = 'APPLEPAY',\n  GOOGLEPAY = 'GOOGLEPAY',\n  PISP = 'PISP',\n  SOFORT = 'SOFORT',\n  PIX = 'PIX',\n}\n\nexport enum PurchaseStatus {\n  INITIALIZED = 'INITIALIZED',\n  PAYMENT_STARTED = 'PAYMENT_STARTED',\n  PAYMENT_IN_PROGRESS = 'PAYMENT_IN_PROGRESS',\n  PAYMENT_FAILED = 'PAYMENT_FAILED',\n  PAYMENT_EXECUTED = 'PAYMENT_EXECUTED',\n  FIAT_RECEIVED = 'FIAT_RECEIVED',\n  FIAT_SENT = 'FIAT_SENT',\n  EXPIRED = 'EXPIRED',\n  CANCELLED = 'CANCELLED',\n  RELEASING = 'RELEASING',\n  RELEASED = 'RELEASED',\n}\n\nexport type TPurchaseExternalId = string;\n\nexport interface IHostConfig {\n  swapAsset?: TAsset;\n  offrampAsset?: TAsset;\n  swapAmount?: TSwapAmount;\n  fiatValue?: TFiatValue;\n  fiatCurrency?: TFiatCurrency;\n  userAddress?: TEthAddress;\n  userEmailAddress?: TEmailAddress;\n  hostApiKey?: THostApiKey;\n  hostLogoUrl: THostLogoUrl;\n  hostAppName: THostAppName;\n  url?: TURL;\n  variant?: AllWidgetVariants;\n  webhookStatusUrl?: TWebhookStatusUrl;\n  finalUrl?: TFinalUrl;\n  containerNode?: TContainerNode;\n  selectedCountryCode?: string;\n  defaultAsset?: TAsset;\n  defaultFlow?: TFlow;\n  enabledFlows?: TFlow[];\n  offrampWebhookV3Url?: TWebhookStatusUrl;\n  useSendCryptoCallback?: boolean;\n  paymentMethodType?: PaymentMethodType;\n  hideExitButton?: boolean;\n  closeable?: boolean;\n  credentialless?: boolean;\n}\n\nexport interface IHostConfigWithSdkParams extends Omit<IHostConfig, 'useSendCryptoCallback'> {\n  sdkType: 'WEB';\n  sdkVersion: string;\n  widgetInstanceId: string;\n  variant: AllWidgetVariants;\n  useSendCryptoCallbackVersion?: typeof SEND_CRYPTO_SUPPORTED_VERSION;\n}\n\nexport interface IAssetInfo {\n  address: string | null;\n  symbol: string;\n  type: string;\n  name: string;\n  decimals: number;\n}\n\nexport interface IPurchase {\n  id: TPurchaseExternalId;\n  endTime: TDateString | null;\n  asset: IAssetInfo;\n  receiverAddress: TAddress;\n  cryptoAmount: TCryptoAmount;\n  fiatCurrency: TFiatCurrency;\n  fiatValue: TFiatValue;\n  assetExchangeRate: TAssetExchangeRate;\n  baseRampFee: TFiatValue;\n  networkFee: TFiatValue;\n  appliedFee: TFiatValue;\n  paymentMethodType: PaymentMethodName;\n  finalTxHash?: TFinalTxHash;\n  createdAt: TDateString;\n  updatedAt: TDateString;\n  status: PurchaseStatus;\n}\n\nexport interface AssetInfo {\n  address: string | null;\n  symbol: string;\n  chain: string;\n  type: string;\n  name: string;\n  decimals: number;\n}\n\nexport interface IOfframpSale {\n  id: string;\n  createdAt: string;\n  crypto: {\n    amount: string;\n    assetInfo: AssetInfo;\n  };\n  fiat: {\n    amount: number;\n    currencySymbol: string;\n  };\n}\n\nexport interface IAction {\n  id: TActionID;\n  newStatus: TNewActionStatus;\n  timestamp: TActionTimestamp;\n  details: TActionDetails;\n}\n\nexport enum EventSeverity {\n  VERBOSE = 'VERBOSE',\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARNING = 'WARNING',\n  ERROR = 'ERROR',\n  CRITICAL = 'CRITICAL',\n}\n\nexport interface IConfigError {\n  fieldName: string;\n  description: string;\n  exampleValue?: string;\n  severity: EventSeverity;\n}\n\nexport interface IWidgetEvent {\n  type: string;\n  payload: any | null;\n  internal?: boolean;\n}\n\nexport enum WidgetEventTypes {\n  WIDGET_CLOSE = 'WIDGET_CLOSE',\n  WIDGET_CONFIG_DONE = 'WIDGET_CONFIG_DONE',\n  WIDGET_CONFIG_FAILED = 'WIDGET_CONFIG_FAILED',\n  PURCHASE_CREATED = 'PURCHASE_CREATED',\n  OFFRAMP_SALE_CREATED = 'OFFRAMP_SALE_CREATED',\n}\n\nexport enum InternalEventTypes {\n  APP_VERSION = 'APP_VERSION',\n  WIDGET_CLOSE_REQUEST = 'WIDGET_CLOSE_REQUEST',\n  WIDGET_CLOSE_REQUEST_CANCELLED = 'WIDGET_CLOSE_REQUEST_CANCELLED',\n  WIDGET_CLOSE_REQUEST_CONFIRMED = 'WIDGET_CLOSE_REQUEST_CONFIRMED',\n  REQUEST_CRYPTO_ACCOUNT = 'REQUEST_CRYPTO_ACCOUNT',\n  SEND_CRYPTO = 'SEND_CRYPTO',\n}\n\nexport type TAllEventTypes = WidgetEventTypes | InternalEventTypes;\n\nexport interface IWidgetCloseEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CLOSE;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseCreatedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_CREATED;\n  payload: {\n    purchase: IPurchase;\n    purchaseViewToken: string;\n    apiUrl: string;\n  };\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IOfframpSaleCreatedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.OFFRAMP_SALE_CREATED;\n  payload: {\n    sale: IOfframpSale;\n    saleViewToken: string;\n    apiUrl: string;\n  };\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetConfigDoneEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CONFIG_DONE;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetConfigFailedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CONFIG_FAILED;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetCloseRequestEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST;\n  payload: null;\n  widgetInstanceId?: string;\n  internal: boolean;\n}\n\nexport interface IRequestCryptoAccountEvent extends IWidgetEvent {\n  type: InternalEventTypes.REQUEST_CRYPTO_ACCOUNT;\n  payload: {\n    type: string;\n    assetSymbol: string;\n  };\n  widgetInstanceId?: string;\n}\n\nexport interface ISendCryptoEvent extends IWidgetEvent {\n  eventVersion: typeof SEND_CRYPTO_SUPPORTED_VERSION;\n  type: InternalEventTypes.SEND_CRYPTO;\n  payload: {\n    assetInfo: AssetInfo;\n    amount: string;\n    address: string;\n  };\n  widgetInstanceId?: string;\n}\n\nexport interface IWidgetCloseRequestCancelledEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED;\n  payload: null;\n  internal: true;\n}\n\nexport interface IWidgetCloseRequestConfirmedEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED;\n  payload: null;\n  internal: true;\n}\n\nexport interface IAppVersionEvent extends IWidgetEvent {\n  type: InternalEventTypes.APP_VERSION;\n  payload: {\n    version: `${number}.${number}`;\n  };\n  widgetInstanceId: string;\n  internal: true;\n}\n\nexport type TWidgetEvents =\n  | IWidgetCloseEvent\n  | IWidgetConfigDoneEvent\n  | IWidgetConfigFailedEvent\n  | IPurchaseCreatedEvent\n  | IOfframpSaleCreatedEvent;\n\nexport type TInternalEvents =\n  | IWidgetCloseRequestEvent\n  | IWidgetCloseRequestCancelledEvent\n  | IWidgetCloseRequestConfirmedEvent\n  | IRequestCryptoAccountEvent\n  | ISendCryptoEvent\n  | IAppVersionEvent;\n\nexport enum InternalSdkEventTypes {\n  REQUEST_CRYPTO_ACCOUNT_RESULT = 'REQUEST_CRYPTO_ACCOUNT_RESULT',\n  SEND_CRYPTO_RESULT = 'SEND_CRYPTO_RESULT',\n}\n\nexport interface IRequestCryptoAccountResultEvent extends IWidgetEvent {\n  type: InternalSdkEventTypes.REQUEST_CRYPTO_ACCOUNT_RESULT;\n  payload:\n    | IOnRequestCryptoAccountResult\n    | {\n        error: string | undefined;\n      };\n  widgetInstanceId?: string;\n}\n\nexport interface ISendCryptoResultEvent extends IWidgetEvent {\n  eventVersion: typeof SEND_CRYPTO_SUPPORTED_VERSION;\n  type: InternalSdkEventTypes.SEND_CRYPTO_RESULT;\n  payload:\n    | IOnSendCryptoResult\n    | {\n        error: string | undefined;\n      };\n  widgetInstanceId?: string;\n}\n\nexport type TSdkEvents = IRequestCryptoAccountResultEvent | ISendCryptoResultEvent;\n\nexport type TAllEvents = TWidgetEvents | TInternalEvents;\n\nexport type WidgetVariantTypes =\n  | 'desktop'\n  | 'mobile'\n  | 'hosted-desktop'\n  | 'hosted-mobile'\n  | 'webview-desktop'\n  | 'webview-mobile';\n\nexport type SyntheticWidgetVariants =\n  | 'hosted-auto'\n  | 'auto'\n  | 'embedded-desktop'\n  | 'embedded-mobile';\n\nexport type AllWidgetVariants = WidgetVariantTypes | SyntheticWidgetVariants;\n\nexport type TUnsubscribeToken = string;\n\nexport type TEventListenerDict = {\n  [EventType in TAllEvents['type']]: IEventListener[];\n};\n\nexport interface IEventListener {\n  internal: boolean;\n  callback(evt: TAllEvents): any;\n}\n\nexport interface IOnRequestCryptoAccountResult {\n  address: string;\n  type?: string;\n  name?: string;\n  assetSymbol?: string;\n}\n\nexport interface IOnSendCryptoResult {\n  txHash: string;\n}\n\nexport type TOnRequestCryptoAccountCallback = (\n  type: string,\n  assetSymbol: string\n) => Promise<IOnRequestCryptoAccountResult>;\n\nexport type TOnSendCryptoCallback = (\n  assetInfo: AssetInfo,\n  amount: string,\n  address: string\n) => Promise<IOnSendCryptoResult>;\n","import {\n  AllWidgetVariants,\n  EventSeverity,\n  IConfigError,\n  IHostConfig,\n  InternalEventTypes,\n  SyntheticWidgetVariants,\n  TAllEventTypes,\n  TEventListenerDict,\n  WidgetEventTypes,\n} from './types';\n\nexport function getRandomIntString(): string {\n  try {\n    return String(crypto.getRandomValues(new Uint32Array(1))[0]);\n  } catch {\n    // if `crypto` is not supported, fall back to Math.random\n    // tslint:disable-next-line:no-magic-numbers\n    return String(Math.floor(Math.random() * 10000000));\n  }\n}\n\nexport const widgetDesktopWidth = 895;\nexport const widgetDesktopHeight = 590;\n\nexport const minWidgetMobileWidth = 320;\nexport const minWidgetMobileHeight = 667;\n\nexport function normalizeConfigAndLogErrorsOnInvalidFields(\n  config: Partial<IHostConfig>\n): IHostConfig {\n  const errors: IConfigError[] = [];\n  const configCopy = { ...config };\n\n  if (\n    ![\n      'desktop',\n      'mobile',\n      'hosted-desktop',\n      'hosted-mobile',\n      'hosted-auto',\n      'auto',\n      'embedded-desktop',\n      'embedded-mobile',\n    ].includes(config.variant!)\n  ) {\n    configCopy.variant = 'desktop';\n\n    errors.push({\n      fieldName: 'variant',\n      description: 'Invalid value for `variant` config field ',\n      exampleValue: `'desktop'`,\n      severity: EventSeverity.WARNING,\n    });\n  }\n\n  if (config.variant === 'embedded-desktop' || config.variant === 'embedded-mobile') {\n    validateContainerNode(config.containerNode, config.variant);\n  }\n\n  if (!['embedded-desktop', 'embedded-mobile'].includes(configCopy.variant!)) {\n    delete configCopy.containerNode;\n  }\n\n  if (typeof config.useSendCryptoCallback !== 'undefined') {\n    delete config.useSendCryptoCallback;\n  }\n\n  if (config.credentialless === undefined) {\n    configCopy.credentialless = false;\n  }\n\n  logErrors(errors);\n\n  return configCopy as IHostConfig;\n}\n\nfunction logErrors(errors: IConfigError[]): void {\n  if (!errors.length) {\n    return;\n  }\n\n  // tslint:disable:no-console\n  console.group('Config errors');\n\n  errors.forEach((error) => {\n    console.group(error.fieldName);\n\n    console.log(error.description);\n    console.log(`Example expected value: ${error.exampleValue}`);\n    console.log(`Severity: ${error.severity}`);\n\n    console.groupEnd();\n  });\n\n  console.groupEnd();\n  // tslint:enable:no-console\n}\n\nexport function initEventListenersDict(): TEventListenerDict {\n  const widgetEventTypes = Array.from(Object.values(WidgetEventTypes));\n  const internalEventTypes = Array.from(Object.values(InternalEventTypes));\n\n  return [...widgetEventTypes, ...internalEventTypes].reduce<TEventListenerDict>(\n    (listenersDict: TEventListenerDict, eventType: TAllEventTypes) => {\n      listenersDict[eventType] = [];\n\n      return listenersDict;\n    },\n    {} as any\n  ) as TEventListenerDict;\n}\n\nexport function determineWidgetVariant(config: IHostConfig): AllWidgetVariants {\n  const mediaQuery = '(min-width: 920px) and (min-height: 630px)';\n  const variant = config.variant?.toLocaleLowerCase();\n\n  if (\n    variant === 'mobile' ||\n    variant === 'desktop' ||\n    variant === 'hosted-mobile' ||\n    variant === 'hosted-desktop' ||\n    variant === 'embedded-desktop' ||\n    variant === 'embedded-mobile'\n  ) {\n    return variant;\n  }\n\n  const isDesktop = window.matchMedia(mediaQuery).matches;\n\n  if (variant === 'hosted-auto') {\n    return isDesktop ? 'hosted-desktop' : 'hosted-mobile';\n  }\n\n  return isDesktop ? 'desktop' : 'mobile';\n}\n\nexport function isHtmlElement(element: Element): element is HTMLElement {\n  return typeof (element as any).blur === 'function';\n}\n\nfunction validateContainerNode(\n  containerNode: HTMLElement | undefined,\n  _variant: SyntheticWidgetVariants\n): void {\n  if (!document.body) {\n    throw new Error(\"Couldn't find <body> element.\");\n  }\n\n  if (!(containerNode instanceof HTMLElement)) {\n    throw new Error('Container node has to be a proper HTML element.');\n  }\n\n  if (!document.body.contains(containerNode)) {\n    throw new Error('Container node must be attached to the document.');\n  }\n}\n\n/**\n * Concatenates `base` with `path`, always treating `path` as a relative path. Ignores:\n *   - trailing slash in `base`\n *   - leading slash in `path`\n * @param base base URL, e.g.: 'http://example.com/api' or 'http://example.com/service/api/'\n * @param path path to append, e.g.: 'user/getByEmail' or '/swap'\n */\nexport function concatRelativePath(base: string | URL, path: string): URL {\n  const normalizedBase = urlWithoutTrailingSlash(base instanceof URL ? base.href : base);\n  const normalizedPath = path.startsWith('/') ? path.substr(1) : path;\n  return new URL(`${normalizedBase}/${normalizedPath}`);\n}\n\nexport function urlWithoutTrailingSlash(url: string): string {\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n}\n","import { baseWidgetUrl } from './consts';\nimport {\n  AllWidgetVariants,\n  IHostConfigWithSdkParams,\n  InternalEventTypes,\n  TAllEvents,\n} from './types';\nimport {\n  minWidgetMobileHeight,\n  minWidgetMobileWidth,\n  widgetDesktopHeight,\n  widgetDesktopWidth,\n} from './utils';\n\nexport function getBaseUrl(config: IHostConfigWithSdkParams): URL {\n  return new URL(config.url || baseWidgetUrl);\n}\n\nexport function initWidgetIframeUrl(config: IHostConfigWithSdkParams): string {\n  const baseUrl = getBaseUrl(config);\n  const hostUrl = window.location.origin;\n\n  const { containerNode, url, ...configWithoutIframeUrl } = config;\n\n  const preparedConfig = { ...configWithoutIframeUrl, hostUrl };\n\n  Object.entries(preparedConfig).forEach(([key, value]) => {\n    if (value) {\n      baseUrl.searchParams.append(key, Array.isArray(value) ? value.join(',') : value.toString());\n    }\n  });\n\n  return baseUrl.toString();\n}\n\nexport function initDOMNodeWithOverlay(\n  url: string,\n  dispatch: (event: TAllEvents) => void,\n  config: IHostConfigWithSdkParams\n): {\n  body: HTMLBodyElement | null;\n  iframe: HTMLIFrameElement;\n  overlay: HTMLDivElement;\n  shadow: ShadowRoot;\n  shadowHost: HTMLDivElement;\n} {\n  const body = document.querySelector('body');\n\n  const shadowHost = document.createElement('div');\n\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n\n  const shadow = shadowHost.attachShadow({ mode: 'open' });\n\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n\n  const iframe = prepareIframeNode(url, config.variant, undefined, config.credentialless);\n  const overlay = prepareOverlayNode(iframe, dispatch);\n\n  overlay.appendChild(iframe);\n  shadow.appendChild(overlay);\n\n  return {\n    body,\n    iframe,\n    overlay,\n    shadow,\n    shadowHost,\n  };\n}\n\nexport function initDOMNodeWithoutOverlay(\n  url: string,\n  _dispatch: (event: TAllEvents) => void,\n  config: IHostConfigWithSdkParams\n): {\n  body: HTMLBodyElement | null;\n  iframe: HTMLIFrameElement;\n  overlay: null;\n  shadow: ShadowRoot;\n  shadowHost: HTMLDivElement;\n  container: HTMLDivElement;\n} {\n  const body = document.querySelector('body');\n\n  const shadowHost = document.createElement('div');\n\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n\n  const shadow = shadowHost.attachShadow({ mode: 'open' });\n\n  const container = document.createElement('div');\n  container.classList.add('embedded-container');\n  container.classList.add('constrained');\n\n  shadow.appendChild(container);\n\n  const loader = document.createElement('div');\n  loader.classList.add('loader-container');\n\n  // tslint:disable:max-line-length\n  loader.innerHTML = `\n    <svg width=\"92\" height=\"60\" viewBox=\"0 0 51 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"loader\">\n      <path d=\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\" fill=\"#21BF73\"></path>\n      <path d=\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\" fill=\"#0A6E5C\"></path>\n      <path d=\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\" fill=\"#21BF73\"></path>\n    </svg>`;\n  // tslint:enable:max-line-length\n\n  container.appendChild(loader);\n\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n\n  const iframe = prepareIframeNode(url, config.variant, config.containerNode);\n\n  container.appendChild(iframe);\n\n  return {\n    body,\n    iframe,\n    overlay: null,\n    shadow,\n    shadowHost,\n    container,\n  };\n}\n\nexport function importFonts(): void {\n  if (document.querySelector('[data-ramp-font]')) {\n    return;\n  }\n\n  const font = document.createElement('link');\n\n  font.setAttribute(\n    'href',\n    'https://fonts.googleapis.com/css?family=Poppins:200,400,500,600,700&display=swap&subset=latin-ext'\n  );\n  font.setAttribute('rel', 'stylesheet');\n  font.setAttribute('data-ramp-font', '');\n\n  document.head.appendChild(font);\n}\n\nfunction prepareIframeNode(\n  url: string,\n  variant: AllWidgetVariants,\n  containerNode?: HTMLElement,\n  credentialless?: boolean\n): HTMLIFrameElement {\n  const iframe = document.createElement('iframe');\n\n  iframe.setAttribute('src', url);\n\n  if (credentialless) {\n    iframe.setAttribute('credentialless', 'credentialless');\n  }\n\n  if (containerNode) {\n    iframe.setAttribute(\n      'width',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopWidth.toString()\n        : containerNode.getBoundingClientRect().width.toString()\n    );\n\n    iframe.setAttribute(\n      'height',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopHeight.toString()\n        : containerNode.getBoundingClientRect().height.toString()\n    );\n  } else {\n    iframe.setAttribute(\n      'width',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopWidth.toString()\n        : window.innerWidth.toString()\n    );\n\n    iframe.setAttribute(\n      'height',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopHeight.toString()\n        : window.innerHeight.toString()\n    );\n  }\n\n  iframe.setAttribute('allow', 'payment; microphone; camera; clipboard-read; clipboard-write');\n\n  iframe.classList.add('iframe');\n\n  return iframe;\n}\n\nexport function makeIframeResponsive(\n  iframe: HTMLIFrameElement,\n  container?: HTMLDivElement,\n  containerNode?: HTMLElement\n) {\n  if (container?.classList.contains('constrained')) {\n    container.classList.remove('constrained');\n  }\n\n  const updateIframeSize = () => {\n    if (containerNode) {\n      iframe.setAttribute('width', containerNode.getBoundingClientRect().width.toString());\n      iframe.setAttribute('height', containerNode.getBoundingClientRect().height.toString());\n    } else {\n      iframe.setAttribute('width', window.innerWidth.toString());\n      iframe.setAttribute('height', window.innerHeight.toString());\n    }\n  };\n\n  updateIframeSize();\n\n  // Create a ResizeObserver to watch for size changes\n  const resizeObserver = new ResizeObserver(() => {\n    updateIframeSize();\n  });\n\n  // Observe either the containerNode or document body for size changes\n  if (containerNode) {\n    resizeObserver.observe(containerNode);\n  } else {\n    resizeObserver.observe(document.body);\n  }\n\n  // Clean up the observer when the iframe is removed\n  const parentNode = iframe.parentNode;\n  if (parentNode) {\n    const mutationObserver = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (Array.from(mutation.removedNodes).includes(iframe)) {\n          resizeObserver.disconnect();\n          mutationObserver.disconnect();\n        }\n      });\n    });\n    mutationObserver.observe(parentNode, { childList: true });\n  }\n\n  return iframe;\n}\n\nfunction prepareOverlayNode(\n  iframe: HTMLIFrameElement,\n  dispatch: (event: TAllEvents) => void\n): HTMLDivElement {\n  const overlay = document.createElement('div');\n\n  overlay.classList.add('overlay');\n\n  const loader = document.createElement('div');\n  loader.classList.add('loader-container');\n\n  // tslint:disable:max-line-length\n  loader.innerHTML = `\n    <svg width=\"92\" height=\"60\" viewBox=\"0 0 51 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"loader\">\n      <path d=\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\" fill=\"#21BF73\"></path>\n      <path d=\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\" fill=\"#0A6E5C\"></path>\n      <path d=\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\" fill=\"#21BF73\"></path>\n    </svg>`;\n  // tslint:enable:max-line-length\n\n  overlay.appendChild(loader);\n\n  overlay.addEventListener('click', (event) => {\n    if (event.target !== iframe && !overlay.querySelectorAll('.close-modal').length) {\n      dispatch({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true,\n      });\n    }\n  });\n\n  return overlay;\n}\n\nexport function areUrlsEqual(url0: string, url1: string): boolean {\n  return new URL(url0).toString() === new URL(url1).toString();\n}\n\nexport function isCloseModalAlreadyOpen(containerNode: HTMLElement): boolean {\n  return containerNode.querySelectorAll('.close-modal').length !== 0;\n}\n\nexport function prepareCloseModalNode(dispatch: (event: TAllEvents) => void): HTMLDivElement {\n  const container = document.createElement('div');\n  container.classList.add('close-modal');\n\n  const textEl = document.createElement('div');\n  textEl.classList.add('close-modal__text');\n  textEl.textContent = 'Are you sure you want to exit Ramp Network and abandon the transaction?';\n\n  const buttonContainer = document.createElement('div');\n  buttonContainer.classList.add('close-modal__button-container');\n\n  const cancelButton = document.createElement('button');\n  cancelButton.setAttribute('type', 'button');\n  cancelButton.classList.add('close-modal__button');\n  cancelButton.classList.add('close-modal__button--cancel');\n  cancelButton.textContent = 'Cancel';\n  cancelButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      payload: null,\n      internal: true,\n    });\n  });\n\n  const exitButton = document.createElement('button');\n  exitButton.setAttribute('type', 'button');\n  exitButton.classList.add('close-modal__button');\n  exitButton.classList.add('close-modal__button--exit');\n  exitButton.textContent = 'Exit';\n  exitButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      payload: null,\n      internal: true,\n    });\n  });\n\n  buttonContainer.appendChild(cancelButton);\n  buttonContainer.appendChild(exitButton);\n\n  container.appendChild(textEl);\n  container.appendChild(buttonContainer);\n\n  return container;\n}\n\nfunction getStylesForShadowDom(variant: AllWidgetVariants): HTMLStyleElement {\n  const styles = document.createElement('style');\n\n  const isMobile =\n    variant === 'mobile' ||\n    variant === 'hosted-mobile' ||\n    variant === 'embedded-mobile' ||\n    variant === 'webview-mobile';\n  const isEmbedded = variant === 'embedded-mobile' || variant === 'embedded-desktop';\n\n  styles.textContent = `\n    .overlay {\n      position: fixed;\n      z-index: 1000;\n      width: 100vw;\n      height: ${isMobile ? '100%;' : '100vh;'}\n      top: 0;\n      left: 0;\n      overflow: hidden;\n      background-color: rgba(0, 0, 0, 0.5);\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: center;\n      ${isMobile ? 'align-items: flex-start;' : 'align-items: center;'}\n    }\n\n    .embedded-container {\n      z-index: 1000;\n      position: relative;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: center;\n      ${isMobile ? 'align-items: flex-start;' : 'align-items: center;'}\n    }\n\n    .embedded-container.constrained {\n      min-width: ${isMobile ? minWidgetMobileWidth : widgetDesktopWidth}px;\n      min-height: ${isMobile ? minWidgetMobileHeight : widgetDesktopHeight}px;\n    }\n\n    .loader-container {\n      align-self: center;\n    }\n\n    .loader {\n      transform-origin: center;\n      animation: logoAnimation 4s linear infinite;\n      width: 100px;\n      height: auto;\n      align-self: center;\n    }\n\n    .loader path:nth-child(3) {\n      transform-origin: center;\n      position: relative;\n    }\n\n    .loader path:nth-child(1) {\n      transform-origin: center;\n      position: relative;\n      animation: box1Animation 4s linear infinite;\n      transform: scale(0.4) translateX(6px);\n    }\n\n    .loader path:nth-child(2) {\n      transform-origin: center;\n      position: relative;\n      animation: box4Animation 4s linear infinite;\n      transform: scale(0.4) translateX(-6px);\n    }\n\n    @keyframes logoAnimation {\n      10% {\n        transform: rotate(180deg);\n      }\n      30%{\n        transform: rotate(360deg);\n      }\n      70% {\n        transform: rotate(360deg);\n      }\n      90% {\n        transform: rotate(520deg);\n      }\n      100% {\n        transform: rotate(720deg);\n      }\n    }\n\n    @keyframes box1Animation {\n      0%, 10% {\n        transform: scale(0.4) translateX(6px);\n      }\n      30%, 70% {\n        transform: scale(1) translateX(0);\n      }\n      90% {\n        transform: scale(0.4) translateX(6px);\n      }\n    }\n\n\n    @keyframes box4Animation {\n      0%, 10% {\n        transform: scale(0.4) translateX(-6px);\n      }\n      30%, 70% {\n        transform: scale(1) translateX(0);\n      }\n      90% {\n        transform: scale(0.4) translateX(-6px);\n      }\n    }\n\n    .iframe {\n      border: none;\n      user-select: none;\n      visibility: hidden;\n      position: absolute;\n      color-scheme: only light;\n    }\n\n    .iframe.visible {\n      visibility: visible;\n      ${\n        !isEmbedded && isMobile\n          ? `\n        width: 100vw;\n        height: 100%;\n      `\n          : ''\n      }\n    }\n\n    .close-modal {\n      font-family: 'Poppins', sans-serif;\n      width: 678px;\n      height: 276px;\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      transform: translate(-50%, -50%);\n      z-index: 9999;\n      box-shadow: 0px 54px 200px rgba(36, 37, 57, 0.2);\n      display: flex;\n      flex-flow: column nowrap;\n      justify-content: flex-start;\n      align-items: center;\n      padding: 35px;\n      border-radius: 8px;\n      background: #fff;\n\n      box-sizing: border-box;\n    }\n\n    .close-modal * {\n      box-sizing: border-box;\n    }\n\n    .close-modal__text {\n      margin: 40px auto 30px;\n      font-weight: 600;\n      font-size: 24px;\n      line-height: 36px;\n      text-align: center;\n\n      color: #242539;\n    }\n\n    .close-modal__button-container {\n      width: 318px;\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .close-modal__button {\n      background: #fff;\n      border: 2px solid #EDEEF3;\n      border-radius: 74px;\n      width: 152px;\n      height: 56px;\n      cursor: pointer;\n      font-weight: 600;\n      font-size: 14px;\n      line-height: 21px;\n      color: #2B2D56;\n      text-transform: uppercase;\n    }\n\n    .close-modal__button--exit {\n      background: #DD3E56;\n      box-shadow: 0px 8px 34px rgba(221, 62, 86, 0.4);\n      color: #fff;\n      border-color: transparent;\n    }\n\n    @supports (width: 100dvw) {\n      .overlay {\n        width: 100dvw;\n      }\n\n      .iframe.visible {\n        ${\n          !isEmbedded && isMobile\n            ? `\n          width: 100dvw;\n          height: 100%;\n        `\n            : ''\n        }\n      }\n    }\n\n    @supports (height: 100dvh) {\n      .overlay {\n        height: ${isMobile ? '100%;' : '100dvh;'}\n      }\n    }\n  `;\n\n  return styles;\n}\n","import { clearAllBodyScrollLocks, disableBodyScroll } from './body-scroll-lock';\nimport { getBaseUrl, makeIframeResponsive } from './init-helpers';\nimport { SDK_VERSION, SEND_CRYPTO_SUPPORTED_VERSION } from './consts';\n\nimport {\n  areUrlsEqual,\n  importFonts,\n  initDOMNodeWithoutOverlay,\n  initDOMNodeWithOverlay,\n  initWidgetIframeUrl,\n  isCloseModalAlreadyOpen,\n  prepareCloseModalNode,\n} from './init-helpers';\n\nimport {\n  IHostConfig,\n  IHostConfigWithSdkParams,\n  InternalEventTypes,\n  InternalSdkEventTypes,\n  IRequestCryptoAccountEvent,\n  TAllEvents,\n  TAllEventTypes,\n  TEventListenerDict,\n  TOnRequestCryptoAccountCallback,\n  IOnRequestCryptoAccountResult,\n  TSdkEvents,\n  TWidgetEvents,\n  WidgetEventTypes,\n  TOnSendCryptoCallback,\n  ISendCryptoEvent,\n  IOnSendCryptoResult,\n  IAppVersionEvent,\n} from './types';\n\nimport {\n  determineWidgetVariant,\n  getRandomIntString,\n  initEventListenersDict,\n  isHtmlElement,\n  normalizeConfigAndLogErrorsOnInvalidFields,\n} from './utils';\n\nexport {\n  type IWidgetCloseEvent as WidgetCloseEvent,\n  type IWidgetCloseRequestCancelledEvent as WidgetCloseRequestCancelledEvent,\n  type IWidgetCloseRequestConfirmedEvent as WidgetCloseRequestConfirmedEvent,\n  type IWidgetCloseRequestEvent as WidgetCloseRequestEvent,\n  type IWidgetConfigDoneEvent as WidgetConfigDoneEvent,\n  type IWidgetEvent as RampInstantEvent,\n  type TWidgetEvents as RampInstantEvents,\n  WidgetEventTypes as RampInstantEventTypes,\n  type AllWidgetVariants as RampInstantWidgetVariantTypes,\n  type IPurchase as RampInstantPurchase,\n} from './types';\n\nexport class RampInstantSDK {\n  public widgetWindow?: Window;\n  public domNodes?: {\n    body: HTMLBodyElement | null;\n    iframe: HTMLIFrameElement;\n    overlay: HTMLDivElement | null;\n    shadowHost: HTMLDivElement;\n    shadow: ShadowRoot;\n    container?: HTMLDivElement;\n  };\n\n  private _config: IHostConfigWithSdkParams;\n  private _rawNormalizedConfig: IHostConfig;\n  private _listeners: TEventListenerDict = initEventListenersDict();\n  private _isVisible: boolean = false;\n  private _onSendCryptoCallback: TOnSendCryptoCallback | undefined = undefined;\n\n  constructor(config: IHostConfig) {\n    importFonts();\n\n    this.unsubscribe = this.unsubscribe.bind(this);\n    this.on = this.on.bind(this);\n    this.show = this.show.bind(this);\n    this._handleEscapeClick = this._handleEscapeClick.bind(this);\n    this._dispatchEvent = this._dispatchEvent.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n    this._on = this._on.bind(this);\n    this._registerSdkEventHandlers = this._registerSdkEventHandlers.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n    this._onSendCrypto = this._onSendCrypto.bind(this);\n\n    this._rawNormalizedConfig = normalizeConfigAndLogErrorsOnInvalidFields({\n      variant: 'desktop',\n      ...config,\n    });\n\n    this._config = {\n      ...this._rawNormalizedConfig,\n      ...this._getHostConfigSdkParams(this._rawNormalizedConfig, config.useSendCryptoCallback),\n    };\n  }\n\n  public show(): RampInstantSDK {\n    if (this._isVisible) {\n      throw new Error('Widget is already visible - you can only call this once per instance');\n    }\n\n    if (document.activeElement && isHtmlElement(document.activeElement)) {\n      document.activeElement.blur();\n    }\n\n    this._registerSdkEventHandlers();\n\n    window.addEventListener('message', this._subscribeToWidgetEvents);\n\n    if (this._isConfiguredAsHosted()) {\n      this._showUsingHostedMode();\n    } else if (this._isConfiguredAsEmbedded()) {\n      this._showUsingEmbeddedMode();\n    } else if (this._isConfiguredWithOverlay()) {\n      this._showUsingOverlayMode();\n    }\n\n    window.addEventListener('keydown', this._handleEscapeClick, true);\n\n    return this;\n  }\n\n  public on<T extends TAllEvents>(\n    type: T['type'] | '*',\n    callback: (event: T) => any\n  ): RampInstantSDK {\n    this._on(type, callback, false);\n\n    return this;\n  }\n\n  public unsubscribe(\n    type: TAllEvents['type'] | '*',\n    callback: (event: TAllEvents) => any\n  ): RampInstantSDK {\n    if (type === '*') {\n      const allTypes = Object.entries(this._listeners);\n\n      allTypes.forEach(([key, eventHandlers]) => {\n        const filteredHandlers = eventHandlers.filter((l) => l.callback !== callback);\n        this._listeners[key as TAllEventTypes] = filteredHandlers;\n      });\n    } else {\n      this._listeners[type] = this._listeners[type]?.filter((l) => l.callback !== callback);\n    }\n\n    return this;\n  }\n\n  public _on<T extends TAllEvents>(\n    type: T['type'] | '*',\n    callback: (event: T) => any,\n    internal: boolean\n  ): void {\n    if (type !== '*' && !this._listeners[type]) {\n      // tslint:disable-next-line:no-console\n      console.warn(\n        `Unknown / unsupported event name - '${type}'. This listener will have no effect.`\n      );\n    }\n\n    if (type === '*') {\n      const allTypes = Object.values(this._listeners);\n      allTypes.forEach((eventHandlers) => eventHandlers.push({ callback, internal }));\n    } else {\n      this._listeners[type]?.push({ callback, internal });\n    }\n  }\n\n  public close(): RampInstantSDK {\n    this._dispatchEvent({\n      type: WidgetEventTypes.WIDGET_CLOSE,\n      payload: null,\n      widgetInstanceId: this._config.widgetInstanceId,\n    });\n\n    return this;\n  }\n\n  public onSendCrypto(callback: TOnSendCryptoCallback): RampInstantSDK {\n    this._onSendCryptoCallback = callback;\n    return this;\n  }\n\n  public onRequestCryptoAccount(callback: TOnRequestCryptoAccountCallback): RampInstantSDK {\n    const onRequestCryptoAccount = async (event: IRequestCryptoAccountEvent) => {\n      let result: IOnRequestCryptoAccountResult;\n      try {\n        result = await callback(event.payload.type, event.payload.assetSymbol);\n        if (!result.address) {\n          throw new Error('Missing address in the callback result');\n        }\n      } catch (e) {\n        let errorMessage: string | undefined;\n        if (typeof e === 'string') {\n          errorMessage = e;\n        } else if (e instanceof Error) {\n          errorMessage = e.message;\n        }\n        this._sendEventToWidget({\n          type: InternalSdkEventTypes.REQUEST_CRYPTO_ACCOUNT_RESULT,\n          payload: {\n            error: errorMessage,\n          },\n        });\n        return;\n      }\n\n      this._sendEventToWidget({\n        type: InternalSdkEventTypes.REQUEST_CRYPTO_ACCOUNT_RESULT,\n        payload: {\n          address: result.address,\n          type: result.type,\n          name: result.name,\n          assetSymbol: result.assetSymbol,\n        },\n      });\n    };\n\n    this._on(InternalEventTypes.REQUEST_CRYPTO_ACCOUNT, onRequestCryptoAccount, true);\n\n    return this;\n  }\n\n  private _subscribeToWidgetEvents(event: MessageEvent): void {\n    if (!event.data) {\n      return;\n    }\n\n    if (!areUrlsEqual(event.origin, getBaseUrl(this._config).origin)) {\n      return;\n    }\n\n    const eventData = event.data as TWidgetEvents;\n\n    if (\n      !eventData.widgetInstanceId ||\n      eventData.widgetInstanceId !== this._config.widgetInstanceId\n    ) {\n      return;\n    }\n\n    this._dispatchEvent(eventData);\n  }\n\n  private _registerSdkEventHandlers(): void {\n    this._on(\n      InternalEventTypes.APP_VERSION,\n      (event: IAppVersionEvent) => {\n        const [major] = event.payload.version.split('.') ?? [];\n        const parsedMajor = Number(major);\n\n        if (parsedMajor >= 2 && this.domNodes?.iframe) {\n          makeIframeResponsive(\n            this.domNodes.iframe,\n            this.domNodes.container,\n            this._config.containerNode\n          );\n          this._makeVisible();\n          this._removeEscapeHandler();\n        }\n      },\n      true\n    );\n\n    this._on(\n      WidgetEventTypes.WIDGET_CLOSE,\n      (_event) => {\n        if (this._isConfiguredAsHosted()) {\n          try {\n            this.widgetWindow?.close();\n          } catch (e) {\n            throw new Error('Could not close the widget window');\n          }\n        } else {\n          this.domNodes?.shadowHost.remove();\n          clearAllBodyScrollLocks();\n        }\n\n        this._teardownEventSubscriptions();\n      },\n      true\n    );\n\n    if (this._config.useSendCryptoCallbackVersion) {\n      this.on(InternalEventTypes.SEND_CRYPTO, this._onSendCrypto);\n    }\n\n    this._on(WidgetEventTypes.WIDGET_CONFIG_DONE, () => this._onConfigEvent(), true);\n    this._on(WidgetEventTypes.WIDGET_CONFIG_FAILED, () => this._onConfigEvent(), true);\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST,\n      (_event) => {\n        if (this._isConfiguredAsHosted() || this._isConfiguredAsEmbedded()) {\n          return;\n        }\n\n        if (this._config.variant === 'mobile' || isCloseModalAlreadyOpen(this.domNodes!.overlay!)) {\n          return;\n        }\n\n        this.domNodes!.overlay!.appendChild(prepareCloseModalNode(this._dispatchEvent));\n      },\n      true\n    );\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      (_event) => {\n        this._dispatchEvent({\n          type: WidgetEventTypes.WIDGET_CLOSE,\n          payload: null,\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n      },\n      true\n    );\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      (_event) => {\n        if (this._isConfiguredAsHosted() || this._isConfiguredAsEmbedded()) {\n          return;\n        }\n\n        const modal = this.domNodes!.overlay!.querySelector('.close-modal');\n\n        if (modal) {\n          modal.remove();\n        }\n      },\n      true\n    );\n  }\n\n  private _sendEventToWidget(event: TSdkEvents): void {\n    if (!this._isVisible) {\n      throw new Error(`Widget is not visible couldn't send the event`);\n    }\n    try {\n      (this.widgetWindow ?? this.domNodes?.iframe.contentWindow)?.postMessage(\n        event,\n        getBaseUrl(this._config).origin\n      );\n      // tslint:disable-next-line:no-empty\n    } catch {}\n  }\n\n  private _dispatchEvent(event: TAllEvents): void {\n    const { type } = event;\n\n    this._listeners[type]?.forEach((handler) => handler.callback(event));\n  }\n\n  private _handleEscapeClick(event: KeyboardEvent): void {\n    const escKeyCode = 27;\n\n    if (event.key === 'Escape' || event.key === 'Esc' || event.keyCode === escKeyCode) {\n      this._dispatchEvent({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true,\n      });\n    }\n  }\n\n  private async _onSendCrypto(event: ISendCryptoEvent): Promise<void> {\n    let result: IOnSendCryptoResult | undefined;\n    if (event.eventVersion !== SEND_CRYPTO_SUPPORTED_VERSION) {\n      // tslint:disable-next-line:no-console\n      console.warn(`unsupported event version - '${event}'. This listener will have no effect.`);\n      return;\n    }\n    try {\n      result = await this._onSendCryptoCallback?.(\n        event.payload.assetInfo,\n        event.payload.amount,\n        event.payload.address\n      );\n      if (!result?.txHash) {\n        throw new Error('Missing txHash in the callback result');\n      }\n    } catch (e) {\n      let errorMessage: string | undefined;\n      if (typeof e === 'string') {\n        errorMessage = e;\n      } else if (e instanceof Error) {\n        errorMessage = e.message;\n      }\n      this._sendEventToWidget({\n        eventVersion: SEND_CRYPTO_SUPPORTED_VERSION,\n        type: InternalSdkEventTypes.SEND_CRYPTO_RESULT,\n        payload: {\n          error: errorMessage,\n        },\n      });\n      return;\n    }\n\n    this._sendEventToWidget({\n      eventVersion: SEND_CRYPTO_SUPPORTED_VERSION,\n      type: InternalSdkEventTypes.SEND_CRYPTO_RESULT,\n      payload: {\n        txHash: result.txHash,\n      },\n    });\n  }\n\n  // Event subscriptions aren't cleared so that host can receive a PAYMENT_SUCCESSFUL event\n  // even after the widget has been closed\n  private _teardownEventSubscriptions(): void {\n    this._removeEscapeHandler();\n    window.removeEventListener('message', this._subscribeToWidgetEvents);\n  }\n\n  private _removeEscapeHandler(): void {\n    window.removeEventListener('keydown', this._handleEscapeClick, true);\n  }\n\n  private _showUsingEmbeddedMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.domNodes = initDOMNodeWithoutOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!this.domNodes?.body) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this._config.containerNode?.appendChild(this.domNodes.shadowHost);\n\n    this._isVisible = true;\n  }\n\n  private _showUsingOverlayMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.domNodes = initDOMNodeWithOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!this.domNodes?.body) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this.domNodes.body.appendChild(this.domNodes.shadowHost);\n\n    this._isVisible = true;\n\n    disableBodyScroll();\n  }\n\n  private _showUsingHostedMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.widgetWindow = window.open(widgetUrl) ?? undefined;\n  }\n\n  private _isConfiguredWithOverlay(): boolean {\n    return ['desktop', 'mobile'].includes(this._config.variant);\n  }\n\n  private _isConfiguredAsHosted(): boolean {\n    return ['hosted-desktop', 'hosted-mobile'].includes(this._config.variant);\n  }\n\n  private _isConfiguredAsEmbedded(): boolean {\n    return ['embedded-desktop', 'embedded-mobile'].includes(this._rawNormalizedConfig.variant!);\n  }\n\n  private _getHostConfigSdkParams(\n    config: IHostConfig,\n    useSendCryptoCallback?: boolean\n  ): Pick<\n    IHostConfigWithSdkParams,\n    | 'sdkType'\n    | 'sdkVersion'\n    | 'variant'\n    | 'widgetInstanceId'\n    | 'useSendCryptoCallbackVersion'\n    | 'closeable'\n  > {\n    const widgetVariant = determineWidgetVariant(config);\n    const closeable = config.closeable ?? ['desktop', 'mobile'].includes(widgetVariant);\n\n    return {\n      sdkType: 'WEB',\n      sdkVersion: SDK_VERSION,\n      variant: widgetVariant,\n      widgetInstanceId: getRandomIntString(),\n      closeable,\n      ...(useSendCryptoCallback\n        ? { useSendCryptoCallbackVersion: SEND_CRYPTO_SUPPORTED_VERSION }\n        : {}),\n    };\n  }\n\n  private _makeVisible() {\n    if (this._isConfiguredAsHosted()) {\n      return;\n    }\n\n    this.domNodes?.iframe.classList.add('visible');\n\n    const loader = this.domNodes?.shadow.querySelector('.loader-container');\n\n    if (loader) {\n      loader.remove();\n    }\n  }\n\n  private _onConfigEvent() {\n    this._makeVisible();\n  }\n}\n"],"names":[],"mappings":"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"}